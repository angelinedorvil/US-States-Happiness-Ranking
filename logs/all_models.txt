C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
Processed v009_rawvalue (v009_denominator) ù reverse=True
Processed v011_rawvalue (v011_denominator) ù reverse=True
Processed v049_rawvalue (v049_denominator) ù reverse=True
Processed v070_rawvalue (v070_denominator) ù reverse=True
Processed v045_rawvalue (v045_denominator) ù reverse=True
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v060_denominator) ù reverse=True
Processed v061_rawvalue (v061_denominator) ù reverse=True
Processed v132_rawvalue (v132_denominator) ù reverse=False
v183_rawvalue not found in 2015, skipping.
v143_rawvalue not found in 2015, skipping.
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v005_denominator) ù reverse=True
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
v168_rawvalue not found in 2015, skipping.
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
v171_rawvalue not found in 2015, skipping.
v151_rawvalue not found in 2015, skipping.
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
v172_rawvalue not found in 2015, skipping.
v141_rawvalue not found in 2015, skipping.
v149_rawvalue not found in 2015, skipping.
v184_rawvalue not found in 2015, skipping.
v177_rawvalue not found in 2015, skipping.
Processed v136_rawvalue (v136_denominator) ù reverse=True
v153_rawvalue not found in 2015, skipping.
v154_rawvalue not found in 2015, skipping.
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
v167_rawvalue not found in 2015, skipping.
v169_rawvalue not found in 2015, skipping.
Processed v036_rawvalue (v036_denominator) ù reverse=True
Processed v042_rawvalue (v042_denominator) ù reverse=True
v144_rawvalue not found in 2015, skipping.
v145_rawvalue not found in 2015, skipping.
v147_rawvalue not found in 2015, skipping.
Processed v009_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v011_rawvalue (v011_denominator) ù reverse=True
Processed v049_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v070_rawvalue (v070_denominator) ù reverse=True
Processed v045_rawvalue (v045_denominator) ù reverse=True
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v061_rawvalue (v061_denominator) ù reverse=True
Processed v132_rawvalue (v051_rawvalue (population)) ù reverse=False
v183_rawvalue not found in 2016, skipping.
Processed v143_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v005_denominator) ù reverse=True
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
v168_rawvalue not found in 2016, skipping.
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
v171_rawvalue not found in 2016, skipping.
v151_rawvalue not found in 2016, skipping.
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
v172_rawvalue not found in 2016, skipping.
Processed v141_rawvalue (v051_rawvalue (population)) ù reverse=True
v149_rawvalue not found in 2016, skipping.
v184_rawvalue not found in 2016, skipping.
v177_rawvalue not found in 2016, skipping.
Processed v136_rawvalue (v136_denominator) ù reverse=True
v153_rawvalue not found in 2016, skipping.
v154_rawvalue not found in 2016, skipping.
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
v167_rawvalue not found in 2016, skipping.
v169_rawvalue not found in 2016, skipping.
Processed v036_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v042_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v144_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v145_rawvalue (v051_rawvalue (population)) ù reverse=True
v147_rawvalue not found in 2016, skipping.
Processed v009_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v011_rawvalue (v011_denominator) ù reverse=True
Processed v049_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v070_rawvalue (v070_denominator) ù reverse=True
Processed v045_rawvalue (v045_denominator) ù reverse=True
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v060_denominator) ù reverse=True
Processed v061_rawvalue (v061_denominator) ù reverse=True
Processed v132_rawvalue (v051_rawvalue (population)) ù reverse=False
v183_rawvalue not found in 2017, skipping.
Processed v143_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v005_denominator) ù reverse=True
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
v168_rawvalue not found in 2017, skipping.
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
v171_rawvalue not found in 2017, skipping.
v151_rawvalue not found in 2017, skipping.
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
v172_rawvalue not found in 2017, skipping.
Processed v141_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v149_rawvalue (v051_rawvalue (population)) ù reverse=True
  Warning: v149_rawvalue had invalid or zero weights for 1 states
  States affected: DC
v184_rawvalue not found in 2017, skipping.
v177_rawvalue not found in 2017, skipping.
Processed v136_rawvalue (v136_denominator) ù reverse=True
v153_rawvalue not found in 2017, skipping.
v154_rawvalue not found in 2017, skipping.
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
v167_rawvalue not found in 2017, skipping.
v169_rawvalue not found in 2017, skipping.
Processed v036_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v042_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v144_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v145_rawvalue (v051_rawvalue (population)) ù reverse=True
v147_rawvalue not found in 2017, skipping.
Processed v009_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v011_rawvalue (v011_denominator) ù reverse=True
Processed v049_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v070_rawvalue (v070_denominator) ù reverse=True
Processed v045_rawvalue (v045_denominator) ù reverse=True
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v060_denominator) ù reverse=True
Processed v061_rawvalue (v061_denominator) ù reverse=True
Processed v132_rawvalue (v132_denominator) ù reverse=False
v183_rawvalue not found in 2018, skipping.
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
Processed v143_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v005_denominator) ù reverse=True
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
v168_rawvalue not found in 2018, skipping.
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
v171_rawvalue not found in 2018, skipping.
v151_rawvalue not found in 2018, skipping.
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
v172_rawvalue not found in 2018, skipping.
Processed v141_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v149_rawvalue (v051_rawvalue (population)) ù reverse=True
v184_rawvalue not found in 2018, skipping.
v177_rawvalue not found in 2018, skipping.
Processed v136_rawvalue (v136_denominator) ù reverse=True
v153_rawvalue not found in 2018, skipping.
v154_rawvalue not found in 2018, skipping.
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
v167_rawvalue not found in 2018, skipping.
v169_rawvalue not found in 2018, skipping.
Processed v036_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v042_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v144_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v145_rawvalue (v051_rawvalue (population)) ù reverse=True
v147_rawvalue not found in 2018, skipping.
Processed v009_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v011_rawvalue (v011_denominator) ù reverse=True
Processed v049_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v070_rawvalue (v070_denominator) ù reverse=True
Processed v045_rawvalue (v045_denominator) ù reverse=True
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v060_denominator) ù reverse=True
Processed v061_rawvalue (v061_denominator) ù reverse=True
Processed v132_rawvalue (v132_denominator) ù reverse=False
v183_rawvalue not found in 2019, skipping.
Processed v143_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
v168_rawvalue not found in 2019, skipping.
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
v171_rawvalue not found in 2019, skipping.
v151_rawvalue not found in 2019, skipping.
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
v172_rawvalue not found in 2019, skipping.
Processed v141_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v149_rawvalue (v149_denominator) ù reverse=True
v184_rawvalue not found in 2019, skipping.
v177_rawvalue not found in 2019, skipping.
Processed v136_rawvalue (v136_denominator) ù reverse=True
Processed v153_rawvalue (v153_denominator) ù reverse=False
Processed v154_rawvalue (v154_denominator) ù reverse=True
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
v167_rawvalue not found in 2019, skipping.
v169_rawvalue not found in 2019, skipping.
Processed v036_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v042_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v144_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v145_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v147_rawvalue (v051_rawvalue (population)) ù reverse=False
Processed v009_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v011_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v049_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v070_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v045_rawvalue (v045_denominator) ù reverse=True
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v061_rawvalue (v061_denominator) ù reverse=True
  Warning: v061_rawvalue had invalid or zero weights for 1 states
  States affected: PA
Processed v132_rawvalue (v132_denominator) ù reverse=False
v183_rawvalue not found in 2020, skipping.
Processed v143_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
v168_rawvalue not found in 2020, skipping.
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
v171_rawvalue not found in 2020, skipping.
v151_rawvalue not found in 2020, skipping.
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
v172_rawvalue not found in 2020, skipping.
Processed v141_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v149_rawvalue (v149_denominator) ù reverse=True
v184_rawvalue not found in 2020, skipping.
v177_rawvalue not found in 2020, skipping.
Processed v136_rawvalue (v136_denominator) ù reverse=True
Processed v153_rawvalue (v153_denominator) ù reverse=False
Processed v154_rawvalue (v154_denominator) ù reverse=True
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
v167_rawvalue not found in 2020, skipping.
v169_rawvalue not found in 2020, skipping.
Processed v036_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v042_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v144_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v145_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v147_rawvalue (v051_rawvalue (population)) ù reverse=False
Processed v009_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v011_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v049_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v070_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v045_rawvalue (v045_denominator) ù reverse=True
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v061_rawvalue (v061_denominator) ù reverse=True
Processed v132_rawvalue (v132_denominator) ù reverse=False
v183_rawvalue not found in 2021, skipping.
Processed v143_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v051_rawvalue (population)) ù reverse=True
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
Processed v168_rawvalue (v168_denominator) ù reverse=False
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
v171_rawvalue not found in 2021, skipping.
v151_rawvalue not found in 2021, skipping.
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
v172_rawvalue not found in 2021, skipping.
Processed v141_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v149_rawvalue (v149_denominator) ù reverse=True
v184_rawvalue not found in 2021, skipping.
v177_rawvalue not found in 2021, skipping.
Processed v136_rawvalue (v136_denominator) ù reverse=True
Processed v153_rawvalue (v153_denominator) ù reverse=False
Processed v154_rawvalue (v154_denominator) ù reverse=True
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
v167_rawvalue not found in 2021, skipping.
v169_rawvalue not found in 2021, skipping.
Processed v036_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v042_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v144_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v145_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v147_rawvalue (v051_rawvalue (population)) ù reverse=False
Processed v009_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v011_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v049_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v070_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v045_rawvalue (v045_denominator) ù reverse=True
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v061_rawvalue (v061_denominator) ù reverse=True
Processed v132_rawvalue (v132_denominator) ù reverse=False
v183_rawvalue not found in 2022, skipping.
Processed v143_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
Processed v168_rawvalue (v168_denominator) ù reverse=False
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
Processed v171_rawvalue (v171_denominator) ù reverse=True
Processed v151_rawvalue (v151_denominator) ù reverse=True
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
Processed v172_rawvalue (v172_denominator) ù reverse=False
Processed v141_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v149_rawvalue (v149_denominator) ù reverse=True
v184_rawvalue not found in 2022, skipping.
v177_rawvalue not found in 2022, skipping.
Processed v136_rawvalue (v136_denominator) ù reverse=True
Processed v153_rawvalue (v153_denominator) ù reverse=False
Processed v154_rawvalue (v154_denominator) ù reverse=True
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
Processed v167_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v169_rawvalue (v051_rawvalue (population)) ù reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 2 states
  States affected: HI, VT
Processed v036_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v042_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v144_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v145_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v147_rawvalue (v051_rawvalue (population)) ù reverse=False
Processed v009_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v011_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v049_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v070_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v045_rawvalue (v045_denominator) ù reverse=True
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v061_rawvalue (v061_denominator) ù reverse=True
Processed v132_rawvalue (v132_denominator) ù reverse=False
v183_rawvalue not found in 2023, skipping.
Processed v143_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
Processed v168_rawvalue (v168_denominator) ù reverse=False
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
Processed v171_rawvalue (v171_denominator) ù reverse=True
Processed v151_rawvalue (v151_denominator) ù reverse=True
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
Processed v172_rawvalue (v172_denominator) ù reverse=False
Processed v141_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v149_rawvalue (v149_denominator) ù reverse=True
v184_rawvalue not found in 2023, skipping.
Processed v177_rawvalue (v177_denominator) ù reverse=False
Processed v136_rawvalue (v136_denominator) ù reverse=True
Processed v153_rawvalue (v153_denominator) ù reverse=False
Processed v154_rawvalue (v154_denominator) ù reverse=True
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
Processed v167_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v169_rawvalue (v051_rawvalue (population)) ù reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 2 states
  States affected: HI, VT
Processed v036_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v042_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v144_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v145_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v147_rawvalue (v051_rawvalue (population)) ù reverse=False
Processed v009_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v011_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v049_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v070_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v045_rawvalue (v045_denominator) ù reverse=True
  Warning: v045_rawvalue had invalid or zero weights for 1 states
  States affected: MD
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v061_rawvalue (v061_denominator) ù reverse=True
Processed v132_rawvalue (v132_denominator) ù reverse=False
v183_rawvalue not found in 2024, skipping.
Processed v143_rawvalue (v051_rawvalue (population)) ù reverse=True
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
Processed v168_rawvalue (v168_denominator) ù reverse=False
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
Processed v171_rawvalue (v171_denominator) ù reverse=True
Processed v151_rawvalue (v151_denominator) ù reverse=True
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
Processed v172_rawvalue (v172_denominator) ù reverse=False
Processed v141_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v149_rawvalue (v149_denominator) ù reverse=True
v184_rawvalue not found in 2024, skipping.
Processed v177_rawvalue (v177_denominator) ù reverse=False
Processed v136_rawvalue (v136_denominator) ù reverse=True
Processed v153_rawvalue (v153_denominator) ù reverse=False
Processed v154_rawvalue (v154_denominator) ù reverse=True
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
Processed v167_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v169_rawvalue (v051_rawvalue (population)) ù reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 2 states
  States affected: HI, VT
Processed v036_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v042_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v144_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v145_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v147_rawvalue (v051_rawvalue (population)) ù reverse=False
Processed v009_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v011_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v049_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v070_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v045_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v014_rawvalue (v014_denominator) ù reverse=True
Processed v138_rawvalue (v138_denominator) ù reverse=True
Processed v060_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v061_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v132_rawvalue (v132_denominator) ù reverse=False
Processed v183_rawvalue (v051_rawvalue (population)) ù reverse=True
  Warning: v183_rawvalue had invalid or zero weights for 11 states
  States affected: AR, CO, HI, IL, LA, ND, NY, OR, PA, SD, VA
Processed v143_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v004_rawvalue (v004_denominator) ù reverse=True
Processed v062_rawvalue (v062_denominator) ù reverse=True
Processed v088_rawvalue (v088_denominator) ù reverse=True
Processed v005_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v085_rawvalue (v085_denominator) ù reverse=True
Processed v131_rawvalue (v131_denominator) ù reverse=True
Processed v024_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v044_rawvalue (v044_denominator) ù reverse=True
Processed v069_rawvalue (v069_denominator) ù reverse=False
Processed v168_rawvalue (v168_denominator) ù reverse=False
Processed v023_rawvalue (v023_denominator) ù reverse=True
Processed v140_rawvalue (v140_denominator) ù reverse=False
Processed v171_rawvalue (v171_denominator) ù reverse=True
Processed v151_rawvalue (v151_denominator) ù reverse=True
Processed v063_rawvalue (v051_rawvalue (population)) ù reverse=False
Processed v172_rawvalue (v172_denominator) ù reverse=False
Processed v141_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v149_rawvalue (v149_denominator) ù reverse=True
Processed v184_rawvalue (v051_rawvalue (population)) ù reverse=True
  Warning: v184_rawvalue had invalid or zero weights for 11 states
  States affected: AR, CO, HI, IL, LA, ND, NY, OR, PA, SD, VA
Processed v177_rawvalue (v177_denominator) ù reverse=False
Processed v136_rawvalue (v136_denominator) ù reverse=True
Processed v153_rawvalue (v153_denominator) ù reverse=False
Processed v154_rawvalue (v154_denominator) ù reverse=True
Processed v067_rawvalue (v067_denominator) ù reverse=True
Processed v137_rawvalue (v137_denominator) ù reverse=True
Processed v167_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v169_rawvalue (v051_rawvalue (population)) ù reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 3 states
  States affected: AK, HI, VT
Processed v036_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v042_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v144_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v145_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v147_rawvalue (v051_rawvalue (population)) ù reverse=False
Final Predicotr Index (2015û2025) saved to results/norm_predictors/final_predictor_index_all_years.csv
Processed v001_rawvalue (v001_denominator) ù reverse=True
Processed v127_rawvalue (v127_denominator) ù reverse=True
Processed v128_rawvalue (v128_denominator) ù reverse=True
Processed v129_rawvalue (v129_denominator) ù reverse=True
Processed v135_rawvalue (v135_denominator) ù reverse=True
v161_rawvalue not found in 2015, skipping.
Processed v015_rawvalue (v015_denominator) ù reverse=True
Processed v039_rawvalue (v039_denominator) ù reverse=True
v148_rawvalue not found in 2015, skipping.
Processed v125_rawvalue (v051_rawvalue (population)) ù reverse=True
  Warning: v125_rawvalue had invalid or zero weights for 2 states
  States affected: AK, HI
Processed v124_rawvalue (v124_denominator) ù reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2015, skipping.
v182_rawvalue not found in 2015, skipping.
v166_rawvalue not found in 2015, skipping.
v181_rawvalue not found in 2015, skipping.
v156_rawvalue not found in 2015, skipping.
Processed v134_rawvalue (v134_denominator) ù reverse=True
Processed v139_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v083_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v133_rawvalue (v133_denominator) ù reverse=False
v155_rawvalue not found in 2015, skipping.
Processed v001_rawvalue (v001_denominator) ù reverse=True
Processed v127_rawvalue (v127_denominator) ù reverse=True
Processed v128_rawvalue (v128_denominator) ù reverse=True
Processed v129_rawvalue (v129_denominator) ù reverse=True
Processed v135_rawvalue (v135_denominator) ù reverse=True
v161_rawvalue not found in 2016, skipping.
Processed v015_rawvalue (v015_denominator) ù reverse=True
Processed v039_rawvalue (v039_denominator) ù reverse=True
v148_rawvalue not found in 2016, skipping.
Processed v125_rawvalue (v051_rawvalue (population)) ù reverse=True
  Warning: v125_rawvalue had invalid or zero weights for 2 states
  States affected: AK, HI
Processed v124_rawvalue (v124_denominator) ù reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 2 states
  States affected: DC, HI
v179_rawvalue not found in 2016, skipping.
v182_rawvalue not found in 2016, skipping.
v166_rawvalue not found in 2016, skipping.
v181_rawvalue not found in 2016, skipping.
v156_rawvalue not found in 2016, skipping.
Processed v134_rawvalue (v134_denominator) ù reverse=True
Processed v139_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v083_rawvalue (v051_rawvalue (population)) ù reverse=True
Processed v133_rawvalue (v133_denominator) ù reverse=False
v155_rawvalue not found in 2016, skipping.
Processed v001_rawvalue (v001_denominator) ù reverse=True
Processed v127_rawvalue (v127_denominator) ù reverse=True
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
Exception ignored in: <function Image.__del__ at 0x00000207CC22E7A0>
Traceback (most recent call last):
  File "C:\Users\angel\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 4046, in __del__
    self.tk.call('image', 'delete', self.name)
RuntimeError: main thread is not in main loop
Exception ignored in: <function Variable.__del__ at 0x00000207CD4330A0>
Traceback (most recent call last):
  File "C:\Users\angel\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 388, in __del__
    if self._tk.getboolean(self._tk.call("info", "exists", self._name)):
RuntimeError: main thread is not in main loop
Exception ignored in: <function Variable.__del__ at 0x00000207CD4330A0>
Traceback (most recent call last):
  File "C:\Users\angel\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 388, in __del__
    if self._tk.getboolean(self._tk.call("info", "exists", self._name)):
RuntimeError: main thread is not in main loop
Exception ignored in: <function Variable.__del__ at 0x00000207CD4330A0>
Traceback (most recent call last):
  File "C:\Users\angel\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 388, in __del__
    if self._tk.getboolean(self._tk.call("info", "exists", self._name)):
RuntimeError: main thread is not in main loop
Exception ignored in: <function Variable.__del__ at 0x00000207CD4330A0>
Traceback (most recent call last):
  File "C:\Users\angel\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 388, in __del__
    if self._tk.getboolean(self._tk.call("info", "exists", self._name)):
RuntimeError: main thread is not in main loop
Tcl_AsyncDelete: async handler deleted by the wrong thread
Process LokyProcess-3:
