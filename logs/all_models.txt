C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v045_denominator)  reverse=True
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v061_denominator)  reverse=True
  Warning: v061_rawvalue had invalid or zero weights for 1 states
  States affected: PA
Processed v132_rawvalue (v132_denominator)  reverse=False
v183_rawvalue not found in 2020, skipping.
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
v168_rawvalue not found in 2020, skipping.
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
v171_rawvalue not found in 2020, skipping.
v151_rawvalue not found in 2020, skipping.
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
v172_rawvalue not found in 2020, skipping.
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
v184_rawvalue not found in 2020, skipping.
v177_rawvalue not found in 2020, skipping.
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
v167_rawvalue not found in 2020, skipping.
v169_rawvalue not found in 2020, skipping.
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v045_denominator)  reverse=True
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v061_denominator)  reverse=True
Processed v132_rawvalue (v132_denominator)  reverse=False
v183_rawvalue not found in 2021, skipping.
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
Processed v168_rawvalue (v168_denominator)  reverse=False
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
v171_rawvalue not found in 2021, skipping.
v151_rawvalue not found in 2021, skipping.
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
v172_rawvalue not found in 2021, skipping.
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
v184_rawvalue not found in 2021, skipping.
v177_rawvalue not found in 2021, skipping.
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
v167_rawvalue not found in 2021, skipping.
v169_rawvalue not found in 2021, skipping.
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v045_denominator)  reverse=True
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v061_denominator)  reverse=True
Processed v132_rawvalue (v132_denominator)  reverse=False
v183_rawvalue not found in 2022, skipping.
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
Processed v168_rawvalue (v168_denominator)  reverse=False
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
Processed v171_rawvalue (v171_denominator)  reverse=True
Processed v151_rawvalue (v151_denominator)  reverse=True
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
Processed v172_rawvalue (v172_denominator)  reverse=False
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
v184_rawvalue not found in 2022, skipping.
v177_rawvalue not found in 2022, skipping.
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
Processed v167_rawvalue (v051_rawvalue (population))  reverse=True
Processed v169_rawvalue (v051_rawvalue (population))  reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 2 states
  States affected: HI, VT
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v045_denominator)  reverse=True
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v061_denominator)  reverse=True
Processed v132_rawvalue (v132_denominator)  reverse=False
v183_rawvalue not found in 2023, skipping.
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
Processed v168_rawvalue (v168_denominator)  reverse=False
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
Processed v171_rawvalue (v171_denominator)  reverse=True
Processed v151_rawvalue (v151_denominator)  reverse=True
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
Processed v172_rawvalue (v172_denominator)  reverse=False
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
v184_rawvalue not found in 2023, skipping.
Processed v177_rawvalue (v177_denominator)  reverse=False
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
Processed v167_rawvalue (v051_rawvalue (population))  reverse=True
Processed v169_rawvalue (v051_rawvalue (population))  reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 2 states
  States affected: HI, VT
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v045_denominator)  reverse=True
  Warning: v045_rawvalue had invalid or zero weights for 1 states
  States affected: MD
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v061_denominator)  reverse=True
Processed v132_rawvalue (v132_denominator)  reverse=False
v183_rawvalue not found in 2024, skipping.
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
Processed v168_rawvalue (v168_denominator)  reverse=False
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
Processed v171_rawvalue (v171_denominator)  reverse=True
Processed v151_rawvalue (v151_denominator)  reverse=True
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
Processed v172_rawvalue (v172_denominator)  reverse=False
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
v184_rawvalue not found in 2024, skipping.
Processed v177_rawvalue (v177_denominator)  reverse=False
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
Processed v167_rawvalue (v051_rawvalue (population))  reverse=True
Processed v169_rawvalue (v051_rawvalue (population))  reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 2 states
  States affected: HI, VT
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v051_rawvalue (population))  reverse=True
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v051_rawvalue (population))  reverse=True
Processed v132_rawvalue (v132_denominator)  reverse=False
Processed v183_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v183_rawvalue had invalid or zero weights for 11 states
  States affected: AR, CO, HI, IL, LA, ND, NY, OR, PA, SD, VA
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
Processed v168_rawvalue (v168_denominator)  reverse=False
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
Processed v171_rawvalue (v171_denominator)  reverse=True
Processed v151_rawvalue (v151_denominator)  reverse=True
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
Processed v172_rawvalue (v172_denominator)  reverse=False
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
Processed v184_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v184_rawvalue had invalid or zero weights for 11 states
  States affected: AR, CO, HI, IL, LA, ND, NY, OR, PA, SD, VA
Processed v177_rawvalue (v177_denominator)  reverse=False
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
Processed v167_rawvalue (v051_rawvalue (population))  reverse=True
Processed v169_rawvalue (v051_rawvalue (population))  reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 3 states
  States affected: AK, HI, VT
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Final Predicotr Index (20202025) saved to results/norm_predictors/final_predictor_index_5_years.csv
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v125_rawvalue had invalid or zero weights for 2 states
  States affected: AK, HI
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2020, skipping.
v182_rawvalue not found in 2020, skipping.
v166_rawvalue not found in 2020, skipping.
v181_rawvalue not found in 2020, skipping.
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2021, skipping.
v182_rawvalue not found in 2021, skipping.
Processed v166_rawvalue (v051_rawvalue (population))  reverse=False
v181_rawvalue not found in 2021, skipping.
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2022, skipping.
v182_rawvalue not found in 2022, skipping.
Processed v166_rawvalue (v166_denominator)  reverse=False
v181_rawvalue not found in 2022, skipping.
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2023, skipping.
v182_rawvalue not found in 2023, skipping.
Processed v166_rawvalue (v166_denominator)  reverse=False
v181_rawvalue not found in 2023, skipping.
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2024, skipping.
v182_rawvalue not found in 2024, skipping.
Processed v166_rawvalue (v166_denominator)  reverse=False
v181_rawvalue not found in 2024, skipping.
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
Processed v179_rawvalue (v179_denominator)  reverse=False
Processed v182_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v182_rawvalue had invalid or zero weights for 1 states
  States affected: CT
Processed v166_rawvalue (v166_denominator)  reverse=False
Processed v181_rawvalue (v181_denominator)  reverse=False
  Warning: v181_rawvalue had invalid or zero weights for 1 states
  States affected: DC
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Hate Crime Data Processed
Final Target Index (20202025) saved to results/norm_targets/final_target_index_5_years.csv
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v125_rawvalue had invalid or zero weights for 2 states
  States affected: AK, HI
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2020, skipping.
v182_rawvalue not found in 2020, skipping.
v166_rawvalue not found in 2020, skipping.
v181_rawvalue not found in 2020, skipping.
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2021, skipping.
v182_rawvalue not found in 2021, skipping.
Processed v166_rawvalue (v051_rawvalue (population))  reverse=False
v181_rawvalue not found in 2021, skipping.
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2022, skipping.
v182_rawvalue not found in 2022, skipping.
Processed v166_rawvalue (v166_denominator)  reverse=False
v181_rawvalue not found in 2022, skipping.
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2023, skipping.
v182_rawvalue not found in 2023, skipping.
Processed v166_rawvalue (v166_denominator)  reverse=False
v181_rawvalue not found in 2023, skipping.
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
v179_rawvalue not found in 2024, skipping.
v182_rawvalue not found in 2024, skipping.
Processed v166_rawvalue (v166_denominator)  reverse=False
v181_rawvalue not found in 2024, skipping.
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Processed v001_rawvalue (v001_denominator)  reverse=True
Processed v127_rawvalue (v127_denominator)  reverse=True
Processed v128_rawvalue (v128_denominator)  reverse=True
Processed v129_rawvalue (v129_denominator)  reverse=True
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
Processed v135_rawvalue (v135_denominator)  reverse=True
Processed v161_rawvalue (v161_denominator)  reverse=True
Processed v015_rawvalue (v015_denominator)  reverse=True
Processed v039_rawvalue (v039_denominator)  reverse=True
Processed v148_rawvalue (v148_denominator)  reverse=True
Processed v125_rawvalue (v051_rawvalue (population))  reverse=True
Processed v124_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v124_rawvalue had invalid or zero weights for 1 states
  States affected: HI
Processed v179_rawvalue (v179_denominator)  reverse=False
Processed v182_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v182_rawvalue had invalid or zero weights for 1 states
  States affected: CT
Processed v166_rawvalue (v166_denominator)  reverse=False
Processed v181_rawvalue (v181_denominator)  reverse=False
  Warning: v181_rawvalue had invalid or zero weights for 1 states
  States affected: DC
Processed v156_rawvalue (v051_rawvalue (population))  reverse=True
Processed v134_rawvalue (v134_denominator)  reverse=True
Processed v139_rawvalue (v051_rawvalue (population))  reverse=True
Processed v083_rawvalue (v083_denominator)  reverse=True
Processed v133_rawvalue (v133_denominator)  reverse=False
Processed v155_rawvalue (v051_rawvalue (population))  reverse=False
Hate Crime Data Processed
Final Target Index (20202025) saved to results/norm_targets/final_target_index_5_years.csv
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v045_denominator)  reverse=True
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v061_denominator)  reverse=True
  Warning: v061_rawvalue had invalid or zero weights for 1 states
  States affected: PA
Processed v132_rawvalue (v132_denominator)  reverse=False
v183_rawvalue not found in 2020, skipping.
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
v168_rawvalue not found in 2020, skipping.
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
v171_rawvalue not found in 2020, skipping.
v151_rawvalue not found in 2020, skipping.
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
v172_rawvalue not found in 2020, skipping.
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
v184_rawvalue not found in 2020, skipping.
v177_rawvalue not found in 2020, skipping.
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
v167_rawvalue not found in 2020, skipping.
v169_rawvalue not found in 2020, skipping.
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v045_denominator)  reverse=True
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v061_denominator)  reverse=True
Processed v132_rawvalue (v132_denominator)  reverse=False
v183_rawvalue not found in 2021, skipping.
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
Processed v168_rawvalue (v168_denominator)  reverse=False
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
v171_rawvalue not found in 2021, skipping.
v151_rawvalue not found in 2021, skipping.
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
v172_rawvalue not found in 2021, skipping.
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
v184_rawvalue not found in 2021, skipping.
v177_rawvalue not found in 2021, skipping.
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
v167_rawvalue not found in 2021, skipping.
v169_rawvalue not found in 2021, skipping.
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v045_denominator)  reverse=True
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v061_denominator)  reverse=True
Processed v132_rawvalue (v132_denominator)  reverse=False
v183_rawvalue not found in 2022, skipping.
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
Processed v168_rawvalue (v168_denominator)  reverse=False
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\src\utils\metrics_utils.py:64: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: pd.Series({var: safe_weighted_mean(g)}))
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\shap\explainers\_tree.py:253: FutureWarning: In the future, passing feature_perturbation='interventional' without providing a background dataset will raise an error. Please provide a background dataset to continue using the interventional approach or set feature_perturbation='auto' to automatically switch approaches.
  warnings.warn(
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
Processed v171_rawvalue (v171_denominator)  reverse=True
Processed v151_rawvalue (v151_denominator)  reverse=True
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
Processed v172_rawvalue (v172_denominator)  reverse=False
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
v184_rawvalue not found in 2022, skipping.
v177_rawvalue not found in 2022, skipping.
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
Processed v167_rawvalue (v051_rawvalue (population))  reverse=True
Processed v169_rawvalue (v051_rawvalue (population))  reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 2 states
  States affected: HI, VT
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v045_denominator)  reverse=True
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v061_denominator)  reverse=True
Processed v132_rawvalue (v132_denominator)  reverse=False
v183_rawvalue not found in 2023, skipping.
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
Processed v168_rawvalue (v168_denominator)  reverse=False
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
Processed v171_rawvalue (v171_denominator)  reverse=True
Processed v151_rawvalue (v151_denominator)  reverse=True
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
Processed v172_rawvalue (v172_denominator)  reverse=False
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
v184_rawvalue not found in 2023, skipping.
Processed v177_rawvalue (v177_denominator)  reverse=False
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
Processed v167_rawvalue (v051_rawvalue (population))  reverse=True
Processed v169_rawvalue (v051_rawvalue (population))  reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 2 states
  States affected: HI, VT
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v045_denominator)  reverse=True
  Warning: v045_rawvalue had invalid or zero weights for 1 states
  States affected: MD
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v061_denominator)  reverse=True
Processed v132_rawvalue (v132_denominator)  reverse=False
v183_rawvalue not found in 2024, skipping.
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
Processed v168_rawvalue (v168_denominator)  reverse=False
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
Processed v171_rawvalue (v171_denominator)  reverse=True
Processed v151_rawvalue (v151_denominator)  reverse=True
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
Processed v172_rawvalue (v172_denominator)  reverse=False
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
v184_rawvalue not found in 2024, skipping.
Processed v177_rawvalue (v177_denominator)  reverse=False
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
Processed v167_rawvalue (v051_rawvalue (population))  reverse=True
Processed v169_rawvalue (v051_rawvalue (population))  reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 2 states
  States affected: HI, VT
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Processed v009_rawvalue (v051_rawvalue (population))  reverse=True
Processed v011_rawvalue (v051_rawvalue (population))  reverse=True
Processed v049_rawvalue (v051_rawvalue (population))  reverse=True
Processed v070_rawvalue (v051_rawvalue (population))  reverse=True
Processed v045_rawvalue (v051_rawvalue (population))  reverse=True
Processed v014_rawvalue (v014_denominator)  reverse=True
Processed v138_rawvalue (v138_denominator)  reverse=True
Processed v060_rawvalue (v051_rawvalue (population))  reverse=True
Processed v061_rawvalue (v051_rawvalue (population))  reverse=True
Processed v132_rawvalue (v132_denominator)  reverse=False
Processed v183_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v183_rawvalue had invalid or zero weights for 11 states
  States affected: AR, CO, HI, IL, LA, ND, NY, OR, PA, SD, VA
Processed v143_rawvalue (v051_rawvalue (population))  reverse=True
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\shap\explainers\_tree.py:253: FutureWarning: In the future, passing feature_perturbation='interventional' without providing a background dataset will raise an error. Please provide a background dataset to continue using the interventional approach or set feature_perturbation='auto' to automatically switch approaches.
  warnings.warn(
Processed v004_rawvalue (v004_denominator)  reverse=True
Processed v062_rawvalue (v062_denominator)  reverse=True
Processed v088_rawvalue (v088_denominator)  reverse=True
Processed v005_rawvalue (v051_rawvalue (population))  reverse=True
Processed v085_rawvalue (v085_denominator)  reverse=True
Processed v131_rawvalue (v131_denominator)  reverse=True
Processed v024_rawvalue (v051_rawvalue (population))  reverse=True
Processed v044_rawvalue (v044_denominator)  reverse=True
Processed v069_rawvalue (v069_denominator)  reverse=False
Processed v168_rawvalue (v168_denominator)  reverse=False
Processed v023_rawvalue (v023_denominator)  reverse=True
Processed v140_rawvalue (v140_denominator)  reverse=False
Processed v171_rawvalue (v171_denominator)  reverse=True
Processed v151_rawvalue (v151_denominator)  reverse=True
Processed v063_rawvalue (v051_rawvalue (population))  reverse=False
Processed v172_rawvalue (v172_denominator)  reverse=False
Processed v141_rawvalue (v051_rawvalue (population))  reverse=True
Processed v149_rawvalue (v149_denominator)  reverse=True
Processed v184_rawvalue (v051_rawvalue (population))  reverse=True
  Warning: v184_rawvalue had invalid or zero weights for 11 states
  States affected: AR, CO, HI, IL, LA, ND, NY, OR, PA, SD, VA
Processed v177_rawvalue (v177_denominator)  reverse=False
Processed v136_rawvalue (v136_denominator)  reverse=True
Processed v153_rawvalue (v153_denominator)  reverse=False
Processed v154_rawvalue (v154_denominator)  reverse=True
Processed v067_rawvalue (v067_denominator)  reverse=True
Processed v137_rawvalue (v137_denominator)  reverse=True
Processed v167_rawvalue (v051_rawvalue (population))  reverse=True
Processed v169_rawvalue (v051_rawvalue (population))  reverse=False
  Warning: v169_rawvalue had invalid or zero weights for 3 states
  States affected: AK, HI, VT
Processed v036_rawvalue (v051_rawvalue (population))  reverse=True
Processed v042_rawvalue (v051_rawvalue (population))  reverse=True
Processed v144_rawvalue (v051_rawvalue (population))  reverse=True
Processed v145_rawvalue (v051_rawvalue (population))  reverse=True
Processed v147_rawvalue (v051_rawvalue (population))  reverse=False
Final Predicotr Index (20202025) saved to results/norm_predictors/final_predictor_index_5_years.csv
Evaluation finished for RandomForest_regression (Regression). Results saved to results\models
Report finished for RandomForest_regression (Regression).
X_df dtypes:
 v009_rawvalue_norm              float64
v011_rawvalue_norm              float64
v049_rawvalue_norm              float64
v070_rawvalue_norm              float64
v045_rawvalue_norm              float64
v014_rawvalue_norm              float64
v138_rawvalue_norm              float64
v060_rawvalue_norm              float64
v061_rawvalue_norm              float64
v132_rawvalue_norm              float64
v143_rawvalue_norm              float64
v004_rawvalue_norm              float64
v062_rawvalue_norm              float64
v088_rawvalue_norm              float64
v005_rawvalue_norm              float64
v085_rawvalue_norm              float64
v131_rawvalue_norm              float64
v024_rawvalue_norm              float64
v044_rawvalue_norm              float64
v069_rawvalue_norm              float64
v023_rawvalue_norm              float64
v140_rawvalue_norm              float64
v063_rawvalue_norm              float64
v141_rawvalue_norm              float64
v149_rawvalue_norm              float64
v136_rawvalue_norm              float64
v153_rawvalue_norm              float64
v154_rawvalue_norm              float64
v067_rawvalue_norm              float64
v137_rawvalue_norm              float64
v036_rawvalue_norm              float64
v042_rawvalue_norm              float64
v144_rawvalue_norm              float64
v145_rawvalue_norm              float64
v147_rawvalue_norm              float64
v168_rawvalue_norm              float64
v171_rawvalue_norm              float64
v151_rawvalue_norm              float64
v172_rawvalue_norm              float64
v167_rawvalue_norm              float64
v169_rawvalue_norm              float64
v177_rawvalue_norm              float64
v183_rawvalue_norm              float64
v184_rawvalue_norm              float64
real_gdp_total_norm             float64
real_pce_total_norm             float64
disposable_income_total_norm    float64
real_pc_income_norm             float64
pc_pce_norm                     float64
rpp_index_norm                  float64
employment_total_norm           float64
arts_ratio_norm                 float64
dtype: object
Any object cols? -> []
Sample suspicious values: {'v009_rawvalue_norm': False, 'v011_rawvalue_norm': False, 'v049_rawvalue_norm': False, 'v070_rawvalue_norm': False, 'v045_rawvalue_norm': False, 'v014_rawvalue_norm': False, 'v138_rawvalue_norm': False, 'v060_rawvalue_norm': False, 'v061_rawvalue_norm': False, 'v132_rawvalue_norm': False, 'v143_rawvalue_norm': False, 'v004_rawvalue_norm': False, 'v062_rawvalue_norm': False, 'v088_rawvalue_norm': False, 'v005_rawvalue_norm': False, 'v085_rawvalue_norm': False, 'v131_rawvalue_norm': False, 'v024_rawvalue_norm': False, 'v044_rawvalue_norm': False, 'v069_rawvalue_norm': False, 'v023_rawvalue_norm': False, 'v140_rawvalue_norm': False, 'v063_rawvalue_norm': False, 'v141_rawvalue_norm': False, 'v149_rawvalue_norm': False, 'v136_rawvalue_norm': False, 'v153_rawvalue_norm': False, 'v154_rawvalue_norm': False, 'v067_rawvalue_norm': False, 'v137_rawvalue_norm': False, 'v036_rawvalue_norm': False, 'v042_rawvalue_norm': False, 'v144_rawvalue_norm': False, 'v145_rawvalue_norm': False, 'v147_rawvalue_norm': False, 'v168_rawvalue_norm': False, 'v171_rawvalue_norm': False, 'v151_rawvalue_norm': False, 'v172_rawvalue_norm': False, 'v167_rawvalue_norm': False, 'v169_rawvalue_norm': False, 'v177_rawvalue_norm': False, 'v183_rawvalue_norm': False, 'v184_rawvalue_norm': False, 'real_gdp_total_norm': False, 'real_pce_total_norm': False, 'disposable_income_total_norm': False, 'real_pc_income_norm': False, 'pc_pce_norm': False, 'rpp_index_norm': False, 'employment_total_norm': False, 'arts_ratio_norm': False}
SHAP analysis complete for RandomForest_regression
Evaluation finished for kNN_regression (Regression). Results saved to results\models
Report finished for kNN_regression (Regression).
Evaluation finished for DecisionTree_regression (Regression). Results saved to results\models
Report finished for DecisionTree_regression (Regression).
Evaluation finished for SVM_regression (Regression). Results saved to results\models
Report finished for SVM_regression (Regression).
Fitting 5 folds for each of 324 candidates, totalling 1620 fits
Evaluation finished for XGBoost_regression (Regression). Results saved to results\models
Report finished for XGBoost_regression (Regression).
X_df dtypes:
 v009_rawvalue_norm              float64
v011_rawvalue_norm              float64
v049_rawvalue_norm              float64
v070_rawvalue_norm              float64
v045_rawvalue_norm              float64
v014_rawvalue_norm              float64
v138_rawvalue_norm              float64
v060_rawvalue_norm              float64
v061_rawvalue_norm              float64
v132_rawvalue_norm              float64
v143_rawvalue_norm              float64
v004_rawvalue_norm              float64
v062_rawvalue_norm              float64
v088_rawvalue_norm              float64
v005_rawvalue_norm              float64
v085_rawvalue_norm              float64
v131_rawvalue_norm              float64
v024_rawvalue_norm              float64
v044_rawvalue_norm              float64
v069_rawvalue_norm              float64
v023_rawvalue_norm              float64
v140_rawvalue_norm              float64
v063_rawvalue_norm              float64
v141_rawvalue_norm              float64
v149_rawvalue_norm              float64
v136_rawvalue_norm              float64
v153_rawvalue_norm              float64
v154_rawvalue_norm              float64
v067_rawvalue_norm              float64
v137_rawvalue_norm              float64
v036_rawvalue_norm              float64
v042_rawvalue_norm              float64
v144_rawvalue_norm              float64
v145_rawvalue_norm              float64
v147_rawvalue_norm              float64
v168_rawvalue_norm              float64
v171_rawvalue_norm              float64
v151_rawvalue_norm              float64
v172_rawvalue_norm              float64
v167_rawvalue_norm              float64
v169_rawvalue_norm              float64
v177_rawvalue_norm              float64
v183_rawvalue_norm              float64
v184_rawvalue_norm              float64
real_gdp_total_norm             float64
real_pce_total_norm             float64
disposable_income_total_norm    float64
real_pc_income_norm             float64
pc_pce_norm                     float64
rpp_index_norm                  float64
employment_total_norm           float64
arts_ratio_norm                 float64
dtype: object
Any object cols? -> []
Sample suspicious values: {'v009_rawvalue_norm': False, 'v011_rawvalue_norm': False, 'v049_rawvalue_norm': False, 'v070_rawvalue_norm': False, 'v045_rawvalue_norm': False, 'v014_rawvalue_norm': False, 'v138_rawvalue_norm': False, 'v060_rawvalue_norm': False, 'v061_rawvalue_norm': False, 'v132_rawvalue_norm': False, 'v143_rawvalue_norm': False, 'v004_rawvalue_norm': False, 'v062_rawvalue_norm': False, 'v088_rawvalue_norm': False, 'v005_rawvalue_norm': False, 'v085_rawvalue_norm': False, 'v131_rawvalue_norm': False, 'v024_rawvalue_norm': False, 'v044_rawvalue_norm': False, 'v069_rawvalue_norm': False, 'v023_rawvalue_norm': False, 'v140_rawvalue_norm': False, 'v063_rawvalue_norm': False, 'v141_rawvalue_norm': False, 'v149_rawvalue_norm': False, 'v136_rawvalue_norm': False, 'v153_rawvalue_norm': False, 'v154_rawvalue_norm': False, 'v067_rawvalue_norm': False, 'v137_rawvalue_norm': False, 'v036_rawvalue_norm': False, 'v042_rawvalue_norm': False, 'v144_rawvalue_norm': False, 'v145_rawvalue_norm': False, 'v147_rawvalue_norm': False, 'v168_rawvalue_norm': False, 'v171_rawvalue_norm': False, 'v151_rawvalue_norm': False, 'v172_rawvalue_norm': False, 'v167_rawvalue_norm': False, 'v169_rawvalue_norm': False, 'v177_rawvalue_norm': False, 'v183_rawvalue_norm': False, 'v184_rawvalue_norm': False, 'real_gdp_total_norm': False, 'real_pce_total_norm': False, 'disposable_income_total_norm': False, 'real_pc_income_norm': False, 'pc_pce_norm': False, 'rpp_index_norm': False, 'employment_total_norm': False, 'arts_ratio_norm': False}
TreeExplainer failed for XGBoost, fallback to KernelExplainer: could not convert string to float: '[5.619618E-1]'

  0%|          | 0/16 [00:00<?, ?it/s]
  6%|6         | 1/16 [00:00<00:02,  5.12it/s]
 12%|#2        | 2/16 [00:00<00:02,  5.62it/s]
 19%|#8        | 3/16 [00:00<00:02,  5.93it/s]
 25%|##5       | 4/16 [00:00<00:01,  6.15it/s]
 31%|###1      | 5/16 [00:00<00:01,  6.26it/s]
 38%|###7      | 6/16 [00:00<00:01,  6.22it/s]
 44%|####3     | 7/16 [00:01<00:01,  6.17it/s]
 50%|#####     | 8/16 [00:01<00:01,  6.18it/s]
 56%|#####6    | 9/16 [00:01<00:01,  5.96it/s]
 62%|######2   | 10/16 [00:01<00:01,  5.92it/s]
 69%|######8   | 11/16 [00:01<00:00,  5.83it/s]
 75%|#######5  | 12/16 [00:02<00:00,  5.66it/s]
 81%|########1 | 13/16 [00:02<00:00,  5.07it/s]
 88%|########7 | 14/16 [00:02<00:00,  4.85it/s]
 94%|#########3| 15/16 [00:02<00:00,  5.03it/s]
100%|##########| 16/16 [00:02<00:00,  5.17it/s]
100%|##########| 16/16 [00:02<00:00,  5.58it/s]
Exception ignored in: <function Image.__del__ at 0x000002430005D6C0>
Traceback (most recent call last):
  File "C:\Users\angel\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 4046, in __del__
    self.tk.call('image', 'delete', self.name)
RuntimeError: main thread is not in main loop
Exception ignored in: <function Variable.__del__ at 0x00000243000F1FC0>
Traceback (most recent call last):
  File "C:\Users\angel\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 388, in __del__
    if self._tk.getboolean(self._tk.call("info", "exists", self._name)):
RuntimeError: main thread is not in main loop
Exception ignored in: <function Variable.__del__ at 0x00000243000F1FC0>
Traceback (most recent call last):
  File "C:\Users\angel\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 388, in __del__
    if self._tk.getboolean(self._tk.call("info", "exists", self._name)):
RuntimeError: main thread is not in main loop
Exception ignored in: <function Variable.__del__ at 0x00000243000F1FC0>
Traceback (most recent call last):
  File "C:\Users\angel\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 388, in __del__
    if self._tk.getboolean(self._tk.call("info", "exists", self._name)):
RuntimeError: main thread is not in main loop
Exception ignored in: <function Variable.__del__ at 0x00000243000F1FC0>
Traceback (most recent call last):
  File "C:\Users\angel\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 388, in __del__
    if self._tk.getboolean(self._tk.call("info", "exists", self._name)):
RuntimeError: main thread is not in main loop
Tcl_AsyncDelete: async handler deleted by the wrong thread
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:359: UserWarning: resource_tracker: There appear to be 18 leaked folder objects to clean up at shutdown
  warnings.warn(
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4c0d7a30774548cb944372ecb7debb9a_9e97c3403a954230adbc21bdba1e50cd: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4c0d7a30774548cb944372ecb7debb9a_63d308b2807646b7baed37294124ef14: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_571ca33fdc7f4eacb24e9ee936598d63_51622eb2d6234314bcca24549c3e7d34: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4c0d7a30774548cb944372ecb7debb9a_424c694f220d41a4818d8872de46c470: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_c12276b91f474acb8d95f4ff7751066d_fa38f57c623a46eb95dcddbf5ebea779: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4c0d7a30774548cb944372ecb7debb9a_0b8f2c7374e345559647a35d9f8ebd23: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_fb3129481776464788637009b9a2796a_26ca8cff962e4759a223d69333c237fe: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4c0d7a30774548cb944372ecb7debb9a_03a8ce3a20e3413fb78f7cd2275b8849: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_53280c00ef364b79b34572bad041b102_e848eae2a3b7419491e69d0b53784b82: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4c0d7a30774548cb944372ecb7debb9a_281fff6014d2467088bdae8ec148b23a: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4be8f5e3d9e54f43a9c4771b8423201d_d23bf8a088534fb890cfe665e1362287: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4c0d7a30774548cb944372ecb7debb9a_3e793588e6b2446a96a3147376a7f829: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_98a67bc441eb43299753163d0e4aec1f_db5adac049244ceaa4105d52ad1b8b11: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4c0d7a30774548cb944372ecb7debb9a_26c0fbac837649f69fa6d97fb5e182d6: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_8990b2ca8a224209aa3de62859df2759_91d74f0e165f491eb74bfe8c259a4428: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4c0d7a30774548cb944372ecb7debb9a_0cf285582b194b4fa40615a181a4e1e7: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_b4353d48e4984af8bc67b8326247939f_20c9b330e10147a7b843eb4e289a0c86: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
C:\Users\angel\US-States-Happiness-Ranking\venv\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py:375: UserWarning: resource_tracker: C:\Users\angel\AppData\Local\Temp\joblib_memmapping_folder_20452_4c0d7a30774548cb944372ecb7debb9a_ab58d1d45ad5486b851e3265de1da12c: FileNotFoundError(2, 'The system cannot find the path specified')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
